import os
# 扫描本地项目，看写入了哪些hive表
rootDir = os.getcwd()
plist0 = ["t_m_user_devicetokenuid_sohu","t_m_user_devicetokenuid_raw_sohu","t_m_user_hot_devicetokenuid_sohu","offline_push_user","t_app_push_status","pugc_video_info","playlistvideo","t_m_video_click_rate","sohutv_small_short_video","prs_sofa_original","prs_video_info","sohu_small_short_video_filtered","kis_base","kiss_base_to_first_category","vrs2_playlist","vrs_category_map","vrs_cont_cate","vrs_category_thrid_map","vrs_category_thrid","vrs_field_value","vrs_video_category","vrs2_playlist_extend","vrs_video_language","vrs_video_area","tv_application","r_uid_long","vrs_intrest_info","r_uid_bc_vv","r_ukey_dislike_log","r_ukey_dislike","r_passport_bc_vv","kis_series_relation","long_video_info_new","vrs_intrest_test","r_uid_short","t_m_video_profile","tv_ver_relation","vrs_tv_set","vrs_field_type","t_m_video_profile_old","r_uid_search","t_m_video_profile_long","r_user_gender","vrs2_playlist_new","prs_t_catecode_label_info","r_uid_dislike_all","short_video_title","r_taglabel_info","r_uid_short_tag_explore","nlp_location","t_user_order_list","prs_pugc_videoinfo_extend","sohutv_user_action_feature","sohutv_video_feature","sohutv_user_feature","sohutv_user_feature_test","r_uid_passport_search_middle","long_video_vv_show","long_video_vv_show_v2","r_uid_passport_search_middle_corpus","offline_profile_analysis","r_uid_search_profile","sohutv_ctr_long_user_feature","sohutv_ctr_long_video_feature","r_yesterday_uid","r_yesterday_no_tag","r_user_show30","r_yesterday_zuobi","r_yesterday_novideoprofile","sohutv_ctr_long_merge_feature","r_uid_short_tag_actor","r_user_applist","videoinfotest2","r_app_action_test","userexception","usercvexception","r_uid_vid_text","wakeuplogtem","no_wakeup_useid","wakeuplogtem19","no_wakeup_useid19","wakeuplogtem20","no_wakeup_useid20","vidlist","usere_gender","r_passport_lastday","r_profile_short_passport","wakeup_log_day","userversioncount","kis_star_main","wakeuplog_nourl","bc_log_normal","r_uid_sohu_column","r_sohu_follow","r_sohu_follow_friend","r_sohu_follow_test","r_uid_sohu_column_test","r_uid_profile_sohu_short_cate1_noclick_v2","r_uid_profile_sohu_short_label_cate_v2","pugc_push_changed_item","prs_video_info_delete","offline_profile_analysis_test","prs_push_changed_item_info","r_sohu_tab_stat_uid_test","userprofilelog","prs_video_allinfo","focuspeopletest","focuspeopletest1","r_sex_predict","real_time_count","prs_catecode_info","t_m_video_profile_pugc","sohutv_ctr_merge","channeled_name","sohutv_ctr_action","r_profile_sohu_all_middle","cold_start_category_tag","r_user_group","r_user_gender_coldstart","r_user_mfo_coldstart","r_user_city_level_coldstart","r_user_coldstart","r_user_pc_middle","r_user_pc_profile","r_user_pc_profile_all","vid_playtime_vv","sohutv_ctr_merge_drop","r_user_long_binge_watch","r_user_long_binge_watch_all","vid_playtime_vv_filter10s","circle_info","sohutv_column_info_tag","sohutv_ctr_action_all","sohutv_ctr_merge_all","cold_count_test","user_group_candicate","cold_count_user_test","sohu_user_tag_cate_info","sohu_user_tag_cate_info_test","r_user_his_column","prs_org_user_cate","r_user_group_test","cffuserviewhistory","prs_push_origin_temp","cold_start_group_analysis","r_uid_dislike_profile","prs_push_temp_delete","user_group_candicate_long","dw_tv_ctr_log","r_sohu_follow_v2","pg_name","r_cold_start_group_profile_analysis","similar_tag","sohu_tv_prs_video_meta_info","prs_pc_entity","r_user_group_index","r_uid_profile_sohu_short_entity_v2","r_long_candidate","r_user_recommend_long_group","r_entiry_key_word","r_user_transe_middle","column_info_all","vid_kis_relation","r_user_long_hot_group_profile_v2","r_profile_monitor","vid_sort_score_relation","r_user_group_analysis","prs_push_video_ee","prs_push_temp","sohu_senior_short_video_filtered","r_user_loc_profile","r_user_loc_cate_id","r_user_loc_cate_profile","r_user_long_hot_index","package_label_table","package_label_table_middle","deviceid_package_start_close_line","deviceid_packages_line","r_user_long_hot_feature","r_user_long_hot_profile","deviceid_brand_line","set_app_train","set_app_predict_data","r_user_channelid_enterid","r_user_sex_result","r_user_long_hot_group_profile","r_user_sex_reg","r_user_app_valid","r_user_app_test_data","r_uid_profile_sohu_long_ctr","r_uid_lda_index","r_video_lda_index","r_user_citys","r_vid_title","sohu_test_filtered","r_uid_ispush","r_uid_profile_sohu_base_all","r_user_action_log","r_uid_passport_vv","r_profile_short_vv","r_uid_profile_sohu_short_all","r_profile_sohu_all_backup","r_profile_user_vv_all","r_uid_profile_sohu_short","r_profile_sohu_base_short_bdhw","r_uid_run_away_user_table","r_uid_tag_video_profile_table","r_uid_passport_category_count_table","t_bc_vv_last_day","t_user_last_show_date","r_profile_tag_profile","r_uid_profile_sohu_long_all","r_user_vv_show","r_user_analysis_tag","r_uid_realtime_history","r_uid_hot_corpus","t_user_dislike_profile_table","sohu_compensator_video_memo","r_realtime_history_day_report","r_video_vv_show_analysis","r_uid_run_away_user_filter_table","r_search_data","r_search_profile_analysis","kis_base_stat","r_search_nomatch_case_data","r_uid_profile_sohu_long_ctr_part","r_user_analysis_tag_clk","t_user_dislike_profile_test","t_m_video_profile_short","r_video_tag_weight","r_user_short_ou_cate","knowledge_graph_table","word_entity_sta_table","knowledge_graph_edge","r_user_search_kis","r_user_search_label","t_m_video_profile_short_prs","r_uid_profile_sohu_short_ctr","r_user_tag_cluster","r_user_tag_cluster_result","r_user_libsvm_feature","t_m_video_profile_short_tag","r_user_tag_cluster_mapping","checkuid","r_relation_encode","r_entity2_encode","r_entity_encode","pc_entity_relation","r_entity_type","r_user_analysis_search","sohu_senior_short_video","sohu_short_video_statistic30","sohu_short_video_statistic7","r_user_short_feature_recall_data","r_user_short_feature_recall_middle_data","r_user_short_feature_recall_middle_data_2","r_user_long_short_feature","r_user_long_short_feature_minmax","r_user_long_short_feature_result","similarytag","r_bili_day_list","sohutv_tag_vector_table","sohutv_similar_tag_table","r_user_app_valid_age","r_bili_day_vid","r_user_age_table","r_user_age_table_middle","r_douban_movie_info","prs_push_keyword_info","r_bili_week_list","r_bili_week_vid","r_vid_pg_show_vv","t_m_collect_user","long_short_prefer_model","r_user_long_last_five","hot_words_search_vids","r_profile_userid_vid_nums","r_user_interest_vv_show","r_uid_profile_sohu_short_search","r_tag_similar_tag","r_tag_similar_result","r_user_interest_profile","youju_hotwords_new","t_m_video_stas","r_uid_passport_show","r_user_vv_show_pg","r_video_vv_show_pg","r_sohu_user_profile_short_entity_v2","coterie_vid_id","t_m_hot_topic","t_m_user_video_subject_profile","sohutv_feature_user_cluster","sohutv_feature_long_video_douban","r_youju_hotwords","r_youju_hotwords_java","t_m_user_video_coterie_profile","t_m_word_similar","ipad_column_info_all","t_distinct_hot_titile_table","vrs_category_first_map_video","vrs_category_second_map_video","vrs_category_thrid_map_video","t_m_star_data","t_bloom_filter_user_data","kiss_base_to_sencond_category","kiss_base_to_third_category","r_profile_kis_cate","t_m_user_short_video_playtime_table","kis_all_info","t_m_entity_mamual_table","sohutv_feature_user_short2long","t_m_user_circle_table","r_passport_lastday_action","t_second_category_name","r_passport_lastday_search_middle","r_passport_lastday_bc_vv","t_m_user_circle_table_v2","r_passport_lastday_uid_vv","t_m_user_recommend_count","t_m_user_recommend_vv_count","r_video_pgc_producer_analysis","r_video_interact","r_video_pgc_producer","t_m_circle_middle_data","t_m_circle_result_v1","t_m_tag_join_tem","t_m_tag_tem","t_m_word_to_vector_tag","t_m_word_2_vector","t_m_member_info","t_tag_julei","t_m_cluster_result","t_m_page_count_table","t_m_user_circle_table_v3","t_m_circle_rec_user_table","t_m_circle_stat_table","category_tem","kis_video_base","kiss_base_to_area","kis_base_partion","t_m_page_count_table_new","t_m_recent_60_user_login","t_m_recent_active_user","t_m_user_circle_table_v4","kis_base_to_star","kis_series","kis_awardprize","t_m_manual_category_table","t_m_tag_name_category","t_m_tag_name_category_table","t_m_recent60_user_login","t_m_recent_user_table","t_m_user_profile_log","t_m_tag_name_table","t_m_tag_name_category_result","user_group_candicate_long_index","rs_high_quality_producer","user_group_candicate_long_analysis","t_m_login_page_table","t_m_user_circle_last_view_table","t_m_user_circle_rec_table","t_m_circle_new_law_table","t_m_user_circle_new_table","sohu_tv_user_circle_test1","r_user_vv_show_long","t_m_user_circle_export_new_table","t_user_dislike_profile","sohutv_feature_short_video_consume_profile","sohutvzhangchaoyang","sohutv_category_tag_tem","r_uid_passport_vv_v2","r_user_long_short_feature_test","r_user_long_short_feature_result_test","r_user_group_noclick","r_user_group_noclick_atrr","r_u_ou_mapping","r_video_pgc_producer_o","t_m_user_circle_last_view_table_test","t_m_user_circle_new_table_test","r_user_page_profile","t_m_page_show_vv_duration","r_new_user_login_rate","r_user_vv_playtime","t_start_page_user_table","t_m_page_show_vv_duration_new","r_user_cc_login_before","r_user_cv_237","rs_high_quality_tag","r_profile_page_circle","r_srv_tv_user_consume","t_m_user_circle_table_v4_test","r_uid_vv_cheat","r_app_vv_nopass","t_m_total_vv_table","t_m_video_profile_long_unfold","r_uid_long_middle","t_m_user_foucs_new_update_count","r_check_label","t_m_user_base_day_tabe","t_m_page_like_label","r_profile_bc_vv","r_srv_tv_user_consume_new","t_m_user_page_day_middle","t_m_total_vv_table_new","t_m_user_base_day_table_new","t_m_user_page_day_result_new","tagnametem","tagnametemtest","r_video_vv_show_long","t_m_user_short_and_long_like_table","t_m_page_like_uid","kis_star_main_filter","t_m_user_like_page_score_table","t_m_user_circle_export_new_table_v3","r_uid_profile_sohu_long_ctr_360","r_kis_star_tag","tagnametem_v2","kis_extend_indo","page_predict_tmp","r_uid_profile_sohu_base_before_v2","r_uid_profile_sohu_base_after_v2","vrs_terminal_map","t_m_user_active_day_long_short_like","t_m_user_shows_day_long_short_like","t_m_user_vv_day_long_short_like","t_m_user_long_short_like_result","t_m_user_long_short_like_label","pg_playtime_vv_predict","sofa_video_checked_202012","t_m_user_shows_day_long_short_like_new","push_temp_delete","sohutv_tag_entity_table","sohutv_tag_entity_name","t_m_tag_entity_label","t_r_m_long_short_video_like_result","r_user_genders_agegroups_flavors","r_uid_long_and_short_video_test","t_m_user_circle_test_ab","r_m_gbdt_playtime_vv_test","sohutvusercirclethredtable","r_uid_base_info","r_passport_uids","r_t_user_last_action_day","r_t_user_last_day_count","r_t_user_last_3_day_table_1","r_t_user_last_3_day_table_task_2","r_t_user_last_3_day_table_task_3","sohutv_cold_page_predict_action","sohutv_feature_long_video_v0","sohutv_feature_long_video","sohu_rec_recall_invert_cate","sohu_rec_recall_invert_tag","r_passport_uid_action","sohu_rec_recall_invert_author","r_passport_uid_vv_show","kis_name_info_scraw","r_profile_tag_profile_all","r_douban_movie_info_incr","prs_ugc_noright_author","kis_star_main_filter_new","t_m_kis_series_distinct_table","t_m_kis_series_distinct_table_result","pg_playtime_vv_predict_result","sohutv_hot_user_page_predict_score","sohutvusercirclethredtablec","sohutv_user_awaydays_pred_resule","t_m_kis_distinct_table_result","push_keyword_hot","r_star_info_baike","r_passport_uid_usage","star_info","t_m_tag_manual_group_table","t_m_kis_manual_group_table","t_m_kis_distinct_table_new_role","t_m_kis_series_manual_group_table","user_page_model_daily_data","user_page_model_ext_data","sohutv_feature_short_video_ctr_online_profile","vrec_video_meta_test","t_m_star_relation","t_m_star_relation_people","t_m_kis_series_group_table","author_merge_info","sys_region","sohutv_recsys_concept","sohutv_recsys_tag_concept","r_mini_program_show","r_mini_program_vv","r_mini_program_vv_show","r_profile_mini_program","sohu_senior_short_video_filtered_hw","kis_video_salvage","r_minors_model","exceptionlog","r_minors_age","r_minors_age_model_merge","kis_douban_tag","sohutv_long_hua_shi_wang_ju","sohutv_broad_list_users","sohu_short_video_consume_data","sohutv_high_quality_pgc_user","title_ee_score","sohu_short_kis_consume","sohu_short_kw_consume","sohu_short_author_consume","prs_analysis_author_info","scn_pg_channeled","sohu_inner_author_content_ppd","sohu_video_consume_mid","sohutv_short_video_short_term_consume_profile","sohutv_recsys_candidate_offline_eval","kis_music_entity","music_entity","sohu_short_video_filtered_consume","r_profile_vv_60_180_360","author_info","r_uid_profile_sohu_base_add","sohu_senior_short_video_test","sohutv_spider_author_info","all_author_info","sohutv_video_detect_result","author_profile","author_profile_new","sohu_tv_video_model","sohu_pugc_user_info","spider_author_mapping","author_consume","sofa_video_filter","sofa_author_origin","sofa_video_checked_202110","sofa_video_checked_202111","sohu_author_merge_info","sohu_short_video_consume","all_author_picture","author_short_category_consume","new_author_stratify_layer","sohutv_author_stratify_layer","r_uid_live_profile","live_info","sohutv_senior_short_video_ext_feature","sohutv_coterie_user_relation","r_uid_assist_info","r_tt_tag_top_profile","r_tt_video_show","r_tt_video_vv","r_tt_tag_rank","sohutv_graph_vertex","sohutv_graph_edge","sohutv_coterie_user_relation_test","sohutv_redis_log","sohutv_rec_user_ctr_stat","user_group_property","sohutv_coldstart_producer_pool","sohu_whitelist_broad_list","r_uid_long_negative","sohu_dup_title","r_uid_attr_vv_score","r_uid_vid_info","r_uid_attr_info","r_uid_short_playtime","r_uid_short_playtime_tag","r_uid_attr_dislike","r_uid_short_attr_cal","r_uid_long_attr_cal","r_uid_short_vv_show","vrs_tv_set_extend","r_uid_long_vid_info","r_uid_profile_sohu_long_ctr_v2","r_uid_profile_sohu_long_all_v2","r_user_short_ou_cate_time","r_uid_long_vid_info_test","r_uid_short_vid_info","r_video_vv_show_pg_v2","tmp_rvf_vid","r_uid_profile_sohu_short_ctr_v2","r_uid_short_consume","r_uid_profile_sohu_short_all_v2","sohutv_short_ee_info","sohutv_short_unscale_ee_info","sohutv_short_recom_accu","short_video_consume_rec","r_uid_bayes_param","sohutv_rec_rvf_vid","sohutv_rec_warn_blocklist_test","r_uid_short_real_cal","r_uid_short_real_all","sohutv_rec_users_request_frequently","sohu_tv_prs_same_kw","rec_tag_score","sohutv_short_vv_action_to_sohu_news","sohutv_short_video_retagging","r_user_short_ou_cate2","short_video","short_video_rm_pay","r_uid_short_weight","label_base_info","vrs_pic_sexy","vrs_comment_bullet_cnt","vrs_comment_bullet_total_cnt","user_is_vip","sohutv_playback_progress","r_uid_short_channel_profile","r_uid_bottom_channel_profile","sohutv_rec_hot_tag","r_user_short_ou_cate_2m","r_user_short_ou_cate_time_2m","sohutv_short_consume_accu","sohutv_abnormal_channel","sohutv_user_short_180days_view_seq_profile","sohu_news_short_video_action_2sohutv","ms_source_info","r_uid_long_vid_page","sohutv_long_page_consume_accu","teenager_filter_author","r_uid_broad_list_profile","sohutv_long_vid_page_consume","long_album_human_edit_tag","long_album_tag","sohutv_broad_list","label_layer_info","r_uid_profile_lifecycle","sohu_senior_short_video_filtered_pic","tmp_test_r_profile_short_vv","r_uid_live_profile_mid_data","pugc_video_meta_info","video_meta_width_height_info","r_uid_long_test","r_uid_long_test2","video_meta_width_height_filterd","short_video_daily","short_video_per_minute","sohutv_short_video_tagcomb","hot_video_need_review","sohutv_short_video_per_minute_score","r_uid_profile_short_weight","sohutv_video_group_base_info","r_profile_tag_invert_blacklist","sohutv_video_group_res_history","r_uid_passport_bc","short_salvage_prs_daily","r_user_long_short_feature_test_test"]
plist = ['kis_series_relation', 'prs_analysis_author_info', 'sohutv_video_group_base_info', 'sohutv_author_stratify_layer', 'author_info', 'kis_star_main_filter_new', 'r_uid_short_attr_cal', 'user_group_property', 'spider_author_mapping', 'sohutv_small_short_video', 'r_profile_sohu_base_short_bdhw', 'kis_star_main_filter', 'sohu_small_short_video_filtered', 'vrs_comment_bullet_total_cnt', 'kiss_base_to_sencond_category', 'r_star_info_baike', 'short_video_per_minute', 'prs_catecode_info', 'sohu_senior_short_video', 'hot_video_need_review', 'sohutv_short_video_per_minute_score', 'prs_video_info', 'sohu_short_kw_consume', 'r_tt_tag_rank', 'sohu_short_video_filtered_consume', 'kis_video_salvage', 'sohutv_spider_author_info', 'sohu_whitelist_broad_list', 'sohu_dup_title', 'sohu_short_video_consume', 'sohu_senior_short_video_filtered_hw', 't_m_video_profile', 'vrs_comment_bullet_cnt', 'live_info', 'r_search_data', 'sofa_video_checked_202110', 'sohu_tv_video_model', 'sofa_video_checked_202012', 'coterie_vid_id', 'author_consume', 'sohutv_broad_list', 'video_meta_width_height_info', 'author_merge_info', 'new_author_stratify_layer', 'sohu_compensator_video_memo', 'sohu_senior_short_video_filtered', 'long_album_tag', 'all_author_picture', 'sohu_tv_prs_video_meta_info', 'author_short_category_consume', 't_m_video_profile_short', 'r_user_vv_show', 'sohu_short_author_consume', 'kis_series', 'kis_base', 'r_minors_age', 'vrs_pic_sexy', 'star_info', 'short_salvage_prs_daily', 'sohu_inner_author_content_ppd', 'sohu_pugc_user_info', 'all_author_info', 'sofa_video_filter', 'vrs_terminal_map', 'label_layer_info', 'sohu_author_merge_info', 't_m_hot_topic', 'r_minors_age_model_merge', 'sohu_video_consume_mid', 'teenager_filter_author', 'kis_star_main', 'r_uid_short', 'long_album_human_edit_tag', 'sohutv_redis_log', 'sofa_video_checked_202111', 'sohu_short_kis_consume', 'sohu_senior_short_video_test', 'sohutv_rec_users_request_frequently', 'push_temp_delete', 'sohu_short_video_consume_data', 't_m_kis_series_distinct_table_result', 'sohutv_tag_entity_table', 'sohutv_video_group_res_history', 'video_meta_width_height_filterd', 'sofa_author_origin', 't_m_kis_series_distinct_table', 'sohutv_short_consume_accu', 'vrs2_playlist', 'r_uid_profile_sohu_long_all', 'short_video', 'kis_all_info', 'kis_base_to_star', 'pugc_video_meta_info', 'label_base_info', 'short_video_rm_pay', 'r_user_applist', 'vrs_field_value', 'sohutv_video_detect_result', 'prs_push_keyword_info', 'sohu_senior_short_video_filtered_pic', 'short_video_daily']

rlist = []

# 文件名（后缀）, 路径名
def scan_file(filename, dirname):
    # print(os.path.join(dirname, filename))
    if ( filename.__contains__(".scala") or filename.__contains__(".java")):
        # print(filename)
        with open(os.path.join(dirname, filename), 'r', encoding='utf-8') as f:
            lines = f.readlines()
            for l in lines:
                for tableName in plist:
                    if(tableName in l and ("output" in l or "insert " in l)):
                        rlist.append(tableName)
                        print(filename + " | " + tableName + " | " + l)
                # print(l)
                # if ("/user/vrecsys/" in l):
                #     print(filename)
                #     print(l)
                #     break




if __name__ == '__main__':
    print(rootDir)
    dir = "D:\\Users\\jiadu218986\\IdeaProjects\\sohutv-rec-datasource\\"
    for dirName, subdirList, fileList in os.walk(dir):
        for fname in fileList:
            scan_file(fname, dirName)

    rlist = list(set(rlist))
    print(len(rlist))
    print(rlist)